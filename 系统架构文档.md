# LLMå®‰å…¨é˜²æŠ¤ç³»ç»Ÿæ¶æ„æ–‡æ¡£

## ğŸ“‹ ç›®å½•
1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
3. [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
4. [å·¥ä½œæµç¨‹](#å·¥ä½œæµç¨‹)
5. [æ•°æ®æµå‘](#æ•°æ®æµå‘)
6. [å®‰å…¨æœºåˆ¶](#å®‰å…¨æœºåˆ¶)
7. [æŠ€æœ¯å®ç°](#æŠ€æœ¯å®ç°)

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

### è®¾è®¡ç›®æ ‡
æœ¬ç³»ç»Ÿæ—¨åœ¨ä¸ºLLMåº”ç”¨æä¾›å…¨é¢çš„å®‰å…¨é˜²æŠ¤ï¼Œé€šè¿‡å¤šå±‚æ¬¡çš„æ•æ„Ÿè¯æ£€æµ‹å’Œå†…å®¹è¿‡æ»¤ï¼Œç¡®ä¿AIæ¨¡å‹çš„è¾“å…¥è¾“å‡ºç¬¦åˆå®‰å…¨è§„èŒƒã€‚

### æ ¸å¿ƒä»·å€¼
- **å®‰å…¨ç¬¬ä¸€**: åŒé‡æ£€æŸ¥æœºåˆ¶ï¼Œç¡®ä¿å†…å®¹å®‰å…¨
- **é«˜æ€§èƒ½**: åŸºäºllm-guardä¼˜åŒ–çš„æ£€æµ‹ç®—æ³•
- **æ˜“æ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•
- **ç”Ÿäº§å°±ç»ª**: å®Œæ•´çš„ç›‘æ§ã€æ—¥å¿—å’Œé”™è¯¯å¤„ç†

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ¥å£å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‘½ä»¤è¡Œæ¥å£  â”‚  äº¤äº’æ¨¡å¼  â”‚  APIæ¥å£  â”‚  æ¼”ç¤ºç¨‹åº          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸šåŠ¡é€»è¾‘å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              LLMGuardSystem (ä¸»æ§åˆ¶å™¨)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  è¯·æ±‚å¤„ç†å™¨      â”‚  â”‚  é…ç½®ç®¡ç†å™¨      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å®‰å…¨é˜²æŠ¤å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ æ•æ„Ÿè¯æ£€æµ‹å™¨     â”‚  â”‚ å®‰å…¨LLMå®¢æˆ·ç«¯   â”‚               â”‚
â”‚  â”‚ (è¾“å…¥æ£€æŸ¥)      â”‚  â”‚ (è¾“å‡ºæ£€æŸ¥)      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®è®¿é—®å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ LLM APIå®¢æˆ·ç«¯   â”‚  â”‚ æ•æ„Ÿè¯æ•°æ®åº“     â”‚               â”‚
â”‚  â”‚ (é€šä¹‰åƒé—®)      â”‚  â”‚ (21930è¯æ±‡)     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŸºç¡€è®¾æ–½å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ æ—¥å¿—ç³»ç»Ÿ        â”‚  â”‚ é…ç½®æ–‡ä»¶        â”‚               â”‚
â”‚  â”‚ (llm_guard.log) â”‚  â”‚ (config.json)   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¾è®¡åŸåˆ™
1. **åˆ†å±‚æ¶æ„**: æ¸…æ™°çš„èŒè´£åˆ†ç¦»
2. **ä¾èµ–æ³¨å…¥**: é™ä½ç»„ä»¶è€¦åˆåº¦
3. **é…ç½®é©±åŠ¨**: çµæ´»çš„å‚æ•°é…ç½®
4. **å¼‚å¸¸å®‰å…¨**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### 1. LLMGuardSystem (ä¸»æ§åˆ¶å™¨)
**æ–‡ä»¶**: `main.py`
**èŒè´£**: ç³»ç»Ÿæ€»æ§åˆ¶å™¨ï¼Œåè°ƒå„ä¸ªç»„ä»¶å·¥ä½œ

```python
class LLMGuardSystem:
    def __init__(self, config_file: str = "config.json")
    def process_request(self, user_input: str, system_prompt: Optional[str] = None)
    def get_system_stats(self)
    def interactive_mode(self)
```

**æ ¸å¿ƒåŠŸèƒ½**:
- åˆå§‹åŒ–æ‰€æœ‰å­ç³»ç»Ÿ
- å¤„ç†ç”¨æˆ·è¯·æ±‚
- åè°ƒå®‰å…¨æ£€æŸ¥æµç¨‹
- æä¾›ç»Ÿè®¡ä¿¡æ¯

### 2. SensitiveWordDetector (æ•æ„Ÿè¯æ£€æµ‹å™¨)
**æ–‡ä»¶**: `sensitive_word_detector.py`
**èŒè´£**: åŸºäºllm-guardå®ç°æ•æ„Ÿè¯æ£€æµ‹

```python
class SensitiveWordDetector:
    def __init__(self, sensitive_words_file, match_type, case_sensitive, redact)
    def scan(self, text: str) -> Tuple[str, bool, float]
    def is_safe(self, text: str) -> bool
    def add_sensitive_words(self, words: List[str])
```

**æ ¸å¿ƒåŠŸèƒ½**:
- åŠ è½½æ•æ„Ÿè¯åº“(21930ä¸ªè¯æ±‡)
- æ‰§è¡Œæ–‡æœ¬æ‰«æ
- è®¡ç®—é£é™©è¯„åˆ†
- åŠ¨æ€æ·»åŠ æ•æ„Ÿè¯

### 3. QwenAPIClient (APIå®¢æˆ·ç«¯)
**æ–‡ä»¶**: `llm_api_client.py`
**èŒè´£**: å°è£…é€šä¹‰åƒé—®APIè°ƒç”¨

```python
class QwenAPIClient:
    def __init__(self, api_key, base_url, model, max_tokens, temperature)
    def chat_completion(self, messages, **kwargs)
    def simple_chat(self, user_message, system_message)
    def stream_chat(self, messages, **kwargs)
```

**æ ¸å¿ƒåŠŸèƒ½**:
- ç®¡ç†APIè¿æ¥
- å¤„ç†è¯·æ±‚å“åº”
- é”™è¯¯é‡è¯•æœºåˆ¶
- æµå¼å“åº”æ”¯æŒ

### 4. SafeLLMClient (å®‰å…¨å®¢æˆ·ç«¯)
**æ–‡ä»¶**: `llm_api_client.py`
**èŒè´£**: é›†æˆå®‰å…¨æ£€æŸ¥çš„LLMå®¢æˆ·ç«¯

```python
class SafeLLMClient:
    def __init__(self, api_client, sensitive_detector)
    def safe_chat(self, user_message, system_message, check_input, check_output)
```

**æ ¸å¿ƒåŠŸèƒ½**:
- è¾“å…¥å®‰å…¨æ£€æŸ¥
- è°ƒç”¨LLM API
- è¾“å‡ºå®‰å…¨æ£€æŸ¥
- ç”Ÿæˆå®‰å…¨æŠ¥å‘Š

## ğŸ”„ å·¥ä½œæµç¨‹

### å®Œæ•´è¯·æ±‚å¤„ç†æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·è¾“å…¥] --> B[LLMGuardSystem.process_request]
    B --> C[åŠ è½½é…ç½®å‚æ•°]
    C --> D[è¾“å…¥æ•æ„Ÿè¯æ£€æµ‹]
    D --> E{è¾“å…¥æ˜¯å¦å®‰å…¨?}
    E -->|å¦| F[è¿”å›é˜»æ­¢å“åº”]
    E -->|æ˜¯| G[è°ƒç”¨é€šä¹‰åƒé—®API]
    G --> H[è·å–æ¨¡å‹å“åº”]
    H --> I[è¾“å‡ºæ•æ„Ÿè¯æ£€æµ‹]
    I --> J{è¾“å‡ºæ˜¯å¦å®‰å…¨?}
    J -->|å¦| K[è¿‡æ»¤æ•æ„Ÿå†…å®¹]
    J -->|æ˜¯| L[è¿”å›åŸå§‹å“åº”]
    K --> M[è¿”å›è¿‡æ»¤åå“åº”]
    L --> N[è®°å½•æ—¥å¿—]
    M --> N
    F --> N
    N --> O[è¿”å›æœ€ç»ˆç»“æœ]
```

### è¯¦ç»†æ­¥éª¤è¯´æ˜

#### ç¬¬ä¸€é˜¶æ®µ: è¯·æ±‚æ¥æ”¶ä¸é¢„å¤„ç†
1. **æ¥æ”¶ç”¨æˆ·è¾“å…¥**: é€šè¿‡å‘½ä»¤è¡Œã€äº¤äº’æ¨¡å¼æˆ–APIæ¥å£
2. **åŠ è½½ç³»ç»Ÿé…ç½®**: è¯»å–config.jsonä¸­çš„å‚æ•°è®¾ç½®
3. **åˆå§‹åŒ–ç»„ä»¶**: åˆ›å»ºæ£€æµ‹å™¨å’ŒAPIå®¢æˆ·ç«¯å®ä¾‹
4. **è®°å½•è¯·æ±‚æ—¶é—´**: å¼€å§‹æ€§èƒ½è®¡æ—¶

#### ç¬¬äºŒé˜¶æ®µ: è¾“å…¥å®‰å…¨æ£€æŸ¥
1. **æ•æ„Ÿè¯æ‰«æ**: ä½¿ç”¨BanSubstringsæ‰«æå™¨æ£€æŸ¥ç”¨æˆ·è¾“å…¥
2. **é£é™©è¯„åˆ†è®¡ç®—**: åŸºäºåŒ¹é…ç»“æœè®¡ç®—é£é™©åˆ†æ•°
3. **å®‰å…¨åˆ¤æ–­**: æ ¹æ®é…ç½®å†³å®šæ˜¯å¦å…è®¸ç»§ç»­å¤„ç†
4. **å†…å®¹æ¸…ç†**: å¦‚æœæ£€æµ‹åˆ°æ•æ„Ÿè¯ï¼Œè¿›è¡Œå†…å®¹æ›¿æ¢

#### ç¬¬ä¸‰é˜¶æ®µ: LLM APIè°ƒç”¨
1. **æ„å»ºè¯·æ±‚**: æ ¼å¼åŒ–APIè¯·æ±‚å‚æ•°
2. **å‘é€è¯·æ±‚**: è°ƒç”¨é€šä¹‰åƒé—®API
3. **å“åº”å¤„ç†**: è§£æAPIè¿”å›ç»“æœ
4. **é”™è¯¯å¤„ç†**: å¤„ç†ç½‘ç»œæˆ–APIé”™è¯¯

#### ç¬¬å››é˜¶æ®µ: è¾“å‡ºå®‰å…¨æ£€æŸ¥
1. **å“åº”æ‰«æ**: å¯¹æ¨¡å‹è¾“å‡ºè¿›è¡Œæ•æ„Ÿè¯æ£€æµ‹
2. **å†…å®¹è¿‡æ»¤**: æ›¿æ¢æˆ–é˜»æ­¢åŒ…å«æ•æ„Ÿè¯çš„å†…å®¹
3. **å®‰å…¨æ ‡è®°**: æ ‡è®°è¾“å‡ºçš„å®‰å…¨çŠ¶æ€
4. **ç”ŸæˆæŠ¥å‘Š**: åˆ›å»ºè¯¦ç»†çš„å®‰å…¨æ£€æŸ¥æŠ¥å‘Š

#### ç¬¬äº”é˜¶æ®µ: ç»“æœè¿”å›ä¸æ—¥å¿—
1. **ç»“æœå°è£…**: å°†æ‰€æœ‰ä¿¡æ¯å°è£…åˆ°ç»“æœå¯¹è±¡
2. **æ—¥å¿—è®°å½•**: è®°å½•å¤„ç†è¿‡ç¨‹å’Œå®‰å…¨äº‹ä»¶
3. **æ€§èƒ½ç»Ÿè®¡**: è®¡ç®—å¤„ç†æ—¶é—´
4. **è¿”å›å“åº”**: å‘ç”¨æˆ·è¿”å›æœ€ç»ˆç»“æœ

## ğŸ“Š æ•°æ®æµå‘

### æ•æ„Ÿè¯æ•°æ®æµ
```
Excelæ–‡ä»¶(æ‹¦æˆªå…³é”®è¯åˆ—è¡¨.xlsx) 
    â†“ [pandasè¯»å–]
Pythonåˆ—è¡¨(21930ä¸ªè¯æ±‡)
    â†“ [å†™å…¥æ–‡ä»¶]
sensitive_words.txt
    â†“ [SensitiveWordDetectoråŠ è½½]
BanSubstringsæ‰«æå™¨
    â†“ [å®æ—¶æ£€æµ‹]
é£é™©è¯„åˆ†å’Œå¤„ç†ç»“æœ
```

### APIè°ƒç”¨æ•°æ®æµ
```
ç”¨æˆ·è¾“å…¥æ–‡æœ¬
    â†“ [å®‰å…¨æ£€æŸ¥]
æ¸…ç†åçš„è¾“å…¥
    â†“ [APIè¯·æ±‚]
é€šä¹‰åƒé—®æœåŠ¡å™¨
    â†“ [APIå“åº”]
æ¨¡å‹ç”Ÿæˆå†…å®¹
    â†“ [å®‰å…¨æ£€æŸ¥]
æœ€ç»ˆå®‰å…¨è¾“å‡º
```

### é…ç½®æ•°æ®æµ
```
config.jsoné…ç½®æ–‡ä»¶
    â†“ [ç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½]
é…ç½®å¯¹è±¡
    â†“ [ä¼ é€’ç»™å„ç»„ä»¶]
ç»„ä»¶åˆå§‹åŒ–å‚æ•°
    â†“ [è¿è¡Œæ—¶ä½¿ç”¨]
ç³»ç»Ÿè¡Œä¸ºæ§åˆ¶
```

## ğŸ›¡ï¸ å®‰å…¨æœºåˆ¶

### å¤šå±‚é˜²æŠ¤ä½“ç³»

#### 1. è¾“å…¥å±‚é˜²æŠ¤
- **æ•æ„Ÿè¯è¿‡æ»¤**: é˜»æ­¢æ¶æ„è¾“å…¥
- **å†…å®¹æ¸…ç†**: è‡ªåŠ¨æ›¿æ¢æ•æ„Ÿå†…å®¹
- **é£é™©è¯„ä¼°**: é‡åŒ–è¾“å…¥é£é™©ç­‰çº§

#### 2. å¤„ç†å±‚é˜²æŠ¤
- **APIå®‰å…¨**: å®‰å…¨çš„APIè°ƒç”¨å°è£…
- **é”™è¯¯éš”ç¦»**: é˜²æ­¢é”™è¯¯ä¿¡æ¯æ³„éœ²
- **è¶…æ—¶æ§åˆ¶**: é¿å…é•¿æ—¶é—´é˜»å¡

#### 3. è¾“å‡ºå±‚é˜²æŠ¤
- **å†…å®¹å®¡æŸ¥**: æ£€æŸ¥æ¨¡å‹è¾“å‡ºå†…å®¹
- **è‡ªåŠ¨è¿‡æ»¤**: ç§»é™¤ä¸å½“ä¿¡æ¯
- **å®‰å…¨æ ‡è®°**: æ ‡è¯†å†…å®¹å®‰å…¨çŠ¶æ€

#### 4. ç›‘æ§å±‚é˜²æŠ¤
- **å®æ—¶æ—¥å¿—**: è®°å½•æ‰€æœ‰å®‰å…¨äº‹ä»¶
- **å¼‚å¸¸å‘Šè­¦**: æ£€æµ‹å¼‚å¸¸è¡Œä¸ºæ¨¡å¼
- **å®¡è®¡è¿½è¸ª**: å®Œæ•´çš„æ“ä½œè®°å½•

### é£é™©è¯„åˆ†æœºåˆ¶
```python
# é£é™©è¯„åˆ†è®¡ç®—é€»è¾‘
if æ£€æµ‹åˆ°æ•æ„Ÿè¯:
    é£é™©è¯„åˆ† = 1.0  # é«˜é£é™©
else:
    é£é™©è¯„åˆ† = -1.0  # å®‰å…¨
    
# åŸºäºé£é™©è¯„åˆ†çš„å¤„ç†ç­–ç•¥
if é£é™©è¯„åˆ† >= é˜ˆå€¼:
    é˜»æ­¢è¯·æ±‚ or è¿‡æ»¤å†…å®¹
else:
    å…è®¸é€šè¿‡
```

## ğŸ’» æŠ€æœ¯å®ç°

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Python 3.8+**: ä¸»è¦å¼€å‘è¯­è¨€
- **llm-guard**: æ•æ„Ÿè¯æ£€æµ‹æ ¸å¿ƒåº“
- **OpenAI SDK**: APIå®¢æˆ·ç«¯åŸºç¡€
- **pandas**: æ•°æ®å¤„ç†
- **logging**: æ—¥å¿—ç³»ç»Ÿ

### å…³é”®ç®—æ³•

#### 1. BanSubstringsç®—æ³•
```python
# llm-guardå†…ç½®çš„é«˜æ•ˆå­—ç¬¦ä¸²åŒ¹é…ç®—æ³•
scanner = BanSubstrings(
    substrings=sensitive_words,
    match_type=MatchType.STR,  # å­—ç¬¦ä¸²çº§åˆ«åŒ¹é…
    case_sensitive=False,      # ä¸åŒºåˆ†å¤§å°å†™
    redact=True               # è‡ªåŠ¨æ›¿æ¢
)
```

#### 2. é£é™©è¯„åˆ†ç®—æ³•
```python
def calculate_risk_score(text, matches):
    if matches:
        # åŸºäºåŒ¹é…æ•°é‡å’Œä¸¥é‡ç¨‹åº¦è®¡ç®—
        return min(1.0, len(matches) * 0.1)
    return -1.0  # å®‰å…¨æ ‡è®°
```

#### 3. å†…å®¹è¿‡æ»¤ç®—æ³•
```python
def filter_content(text, sensitive_words):
    for word in sensitive_words:
        if word in text:
            text = text.replace(word, "[REDACT]")
    return text
```

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### 1. æ•æ„Ÿè¯æ£€æµ‹ä¼˜åŒ–
- **é¢„ç¼–è¯‘æ¨¡å¼**: å¯åŠ¨æ—¶é¢„ç¼–è¯‘æ•æ„Ÿè¯æ¨¡å¼
- **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜å¸¸è§æ£€æµ‹ç»“æœ
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡æ–‡æœ¬æ£€æµ‹

#### 2. APIè°ƒç”¨ä¼˜åŒ–
- **è¿æ¥æ± **: å¤ç”¨HTTPè¿æ¥
- **å¼‚æ­¥å¤„ç†**: æ”¯æŒå¹¶å‘è¯·æ±‚
- **é‡è¯•æœºåˆ¶**: æ™ºèƒ½é”™è¯¯é‡è¯•

#### 3. å†…å­˜ä¼˜åŒ–
- **å»¶è¿ŸåŠ è½½**: æŒ‰éœ€åŠ è½½æ•æ„Ÿè¯åº“
- **å†…å­˜å›æ”¶**: åŠæ—¶é‡Šæ”¾ä¸ç”¨çš„èµ„æº
- **å¯¹è±¡æ± **: å¤ç”¨æ£€æµ‹å™¨å¯¹è±¡

### æ‰©å±•æ€§è®¾è®¡

#### 1. æ’ä»¶åŒ–æ¶æ„
```python
# æ”¯æŒè‡ªå®šä¹‰æ£€æµ‹å™¨
class CustomDetector(BaseDetector):
    def scan(self, text):
        # è‡ªå®šä¹‰æ£€æµ‹é€»è¾‘
        pass

# æ³¨å†Œåˆ°ç³»ç»Ÿ
system.register_detector(CustomDetector())
```

#### 2. é…ç½®é©±åŠ¨
```json
{
  "detectors": [
    {
      "type": "BanSubstrings",
      "config": {...}
    },
    {
      "type": "CustomDetector", 
      "config": {...}
    }
  ]
}
```

#### 3. APIé€‚é…å™¨
```python
# æ”¯æŒå¤šç§LLM API
class APIAdapter:
    def adapt_request(self, request):
        # é€‚é…ä¸åŒAPIæ ¼å¼
        pass
    
    def adapt_response(self, response):
        # ç»Ÿä¸€å“åº”æ ¼å¼
        pass
```

---

è¿™ä¸ªç³»ç»Ÿé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„å’Œå¤šå±‚é˜²æŠ¤æœºåˆ¶ï¼Œä¸ºLLMåº”ç”¨æä¾›äº†å…¨é¢çš„å®‰å…¨ä¿éšœã€‚æ¯ä¸ªç»„ä»¶éƒ½æœ‰æ˜ç¡®çš„èŒè´£ï¼Œæ•´ä¸ªç³»ç»Ÿå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚

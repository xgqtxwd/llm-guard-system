# LLMå®‰å…¨é˜²æŠ¤ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

åŸºäºå¼€æºåº“llm-guardå®ç°çš„æ•æ„Ÿè¯æ£€æµ‹å’Œæ¨¡å‹è¾“å‡ºé™åˆ¶ç³»ç»Ÿï¼Œä¸“é—¨ä¸ºé€šä¹‰åƒé—®APIè®¾è®¡ï¼ŒåŒ…å«21930+ä¸­æ–‡æ•æ„Ÿè¯åº“ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
llm-guard/
â”œâ”€â”€ main.py                    # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ sensitive_word_detector.py # æ•æ„Ÿè¯æ£€æµ‹æ¨¡å—
â”œâ”€â”€ llm_api_client.py         # LLM APIå®¢æˆ·ç«¯
â”œâ”€â”€ demo.py                   # æ¼”ç¤ºç¨‹åº
â”œâ”€â”€ test_llm_guard.py         # æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ config.json               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ .env                      # ç¯å¢ƒå˜é‡
â”œâ”€â”€ requirements.txt          # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ sensitive_words.txt       # æ•æ„Ÿè¯åˆ—è¡¨(21930ä¸ª)
â”œâ”€â”€ README.md                 # è¯¦ç»†æ–‡æ¡£
â””â”€â”€ ä½¿ç”¨æŒ‡å—.md               # æœ¬æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
pip install llm-guard openai python-dotenv
```

### 2. é…ç½®APIå¯†é’¥
ç¼–è¾‘ `config.json` æ–‡ä»¶ä¸­çš„APIå¯†é’¥ï¼š
```json
{
  "api_client": {
    "api_key": "your_api_key_here",
    "base_url": "https://dashscope.aliyuncs.com/compatible-mode/v1",
    "model": "qwen-plus"
  }
}
```

### 3. è¿è¡Œç¨‹åº

#### äº¤äº’æ¨¡å¼
```bash
python main.py --interactive
```

#### ç›´æ¥å¤„ç†æ–‡æœ¬
```bash
python main.py --input "æ‚¨è¦æ£€æµ‹çš„æ–‡æœ¬"
```

#### è¿è¡Œæ¼”ç¤º
```bash
python demo.py
```

#### è¿è¡Œæµ‹è¯•
```bash
python test_llm_guard.py
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### 1. æ•æ„Ÿè¯æ£€æµ‹
- âœ… æ”¯æŒ21930+ä¸­æ–‡æ•æ„Ÿè¯
- âœ… åŸºäºllm-guardçš„BanSubstringsæ‰«æå™¨
- âœ… æ”¯æŒå­—ç¬¦ä¸²çº§åˆ«å’Œå•è¯çº§åˆ«åŒ¹é…
- âœ… è‡ªåŠ¨ç”¨[REDACT]æ›¿æ¢æ•æ„Ÿè¯
- âœ… é£é™©è¯„åˆ†æœºåˆ¶

### 2. æ¨¡å‹APIé›†æˆ
- âœ… å®Œæ•´æ”¯æŒé€šä¹‰åƒé—®API
- âœ… å…¼å®¹OpenAI APIæ ¼å¼
- âœ… æ”¯æŒæµå¼å’Œéæµå¼å“åº”
- âœ… è‡ªåŠ¨é”™è¯¯å¤„ç†å’Œé‡è¯•

### 3. å®‰å…¨é˜²æŠ¤
- âœ… è¾“å…¥è¾“å‡ºåŒé‡æ£€æŸ¥
- âœ… å®æ—¶é£é™©è¯„åˆ†
- âœ… è¯¦ç»†æ—¥å¿—è®°å½•
- âœ… çµæ´»é…ç½®é€‰é¡¹

## ğŸ“Š ä½¿ç”¨ç¤ºä¾‹

### Python APIè°ƒç”¨

```python
from main import LLMGuardSystem

# åˆå§‹åŒ–ç³»ç»Ÿ
system = LLMGuardSystem("config.json")

# å¤„ç†ç”¨æˆ·è¯·æ±‚
result = system.process_request("ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬")

# æŸ¥çœ‹ç»“æœ
print(f"å›å¤: {result['response']}")
print(f"è¾“å…¥å®‰å…¨: {result['input_safe']}")
print(f"è¾“å‡ºå®‰å…¨: {result['output_safe']}")
print(f"é£é™©è¯„åˆ†: {result['input_risk_score']}")
```

### æ•æ„Ÿè¯æ£€æµ‹

```python
from sensitive_word_detector import create_detector

# åˆ›å»ºæ£€æµ‹å™¨
detector = create_detector()

# æ£€æµ‹æ–‡æœ¬
text = "å¾…æ£€æµ‹çš„æ–‡æœ¬å†…å®¹"
sanitized, is_safe, risk_score = detector.scan(text)

print(f"åŸæ–‡: {text}")
print(f"å®‰å…¨: {is_safe}")
print(f"é£é™©è¯„åˆ†: {risk_score}")
print(f"å¤„ç†å: {sanitized}")
```

## âš™ï¸ é…ç½®è¯´æ˜

### æ•æ„Ÿè¯æ£€æµ‹é…ç½®
```json
{
  "sensitive_detector": {
    "sensitive_words_file": "sensitive_words.txt",
    "match_type": "str",           // "str" æˆ– "word"
    "case_sensitive": false,       // æ˜¯å¦åŒºåˆ†å¤§å°å†™
    "redact": true,               // æ˜¯å¦æ›¿æ¢æ•æ„Ÿè¯
    "contains_all": false         // æ˜¯å¦éœ€è¦åŒ…å«æ‰€æœ‰æ•æ„Ÿè¯
  }
}
```

### APIå®¢æˆ·ç«¯é…ç½®
```json
{
  "api_client": {
    "api_key": "your_api_key",
    "base_url": "https://dashscope.aliyuncs.com/compatible-mode/v1",
    "model": "qwen-plus",
    "max_tokens": 2000,
    "temperature": 0.7
  }
}
```

### å®‰å…¨ç­–ç•¥é…ç½®
```json
{
  "safety": {
    "check_input": true,          // æ˜¯å¦æ£€æŸ¥è¾“å…¥
    "check_output": true,         // æ˜¯å¦æ£€æŸ¥è¾“å‡º
    "log_blocked_requests": true  // æ˜¯å¦è®°å½•è¢«é˜»æ­¢çš„è¯·æ±‚
  }
}
```

## ğŸ” ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—æ–‡ä»¶
- ä½ç½®: `llm_guard.log`
- åŒ…å«: APIè°ƒç”¨ã€æ•æ„Ÿè¯æ£€æµ‹ã€å®‰å…¨äº‹ä»¶
- æ ¼å¼: æ—¶é—´æˆ³ - æ¨¡å— - çº§åˆ« - æ¶ˆæ¯

### ç›‘æ§æŒ‡æ ‡
- æ•æ„Ÿè¯æ£€æµ‹æ¬¡æ•°
- APIè°ƒç”¨ç»Ÿè®¡
- è¢«é˜»æ­¢çš„è¯·æ±‚
- é£é™©è¯„åˆ†åˆ†å¸ƒ

## ğŸ› ï¸ è‡ªå®šä¹‰æ‰©å±•

### æ·»åŠ è‡ªå®šä¹‰æ•æ„Ÿè¯
```python
# æ–¹æ³•1: ç¼–è¾‘sensitive_words.txtæ–‡ä»¶
# æ¯è¡Œä¸€ä¸ªæ•æ„Ÿè¯

# æ–¹æ³•2: ç¨‹åºä¸­åŠ¨æ€æ·»åŠ 
detector.add_sensitive_words(["æ–°æ•æ„Ÿè¯1", "æ–°æ•æ„Ÿè¯2"])
```

### è‡ªå®šä¹‰APIå®¢æˆ·ç«¯
```python
from llm_api_client import QwenAPIClient

# åˆ›å»ºè‡ªå®šä¹‰å®¢æˆ·ç«¯
client = QwenAPIClient(
    api_key="your_key",
    model="qwen-turbo",
    temperature=0.5
)
```

## ğŸš¨ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•è°ƒæ•´æ•æ„Ÿè¯æ£€æµ‹çš„ä¸¥æ ¼ç¨‹åº¦ï¼Ÿ
A: ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ `match_type` å‚æ•°ï¼š
- `"str"`: å­—ç¬¦ä¸²çº§åˆ«åŒ¹é…ï¼ˆæ›´ä¸¥æ ¼ï¼‰
- `"word"`: å•è¯çº§åˆ«åŒ¹é…ï¼ˆè¾ƒå®½æ¾ï¼‰

### Q: å¦‚ä½•å¤„ç†è¯¯æŠ¥ï¼Ÿ
A: 
1. æ£€æŸ¥æ•æ„Ÿè¯åˆ—è¡¨ï¼Œç§»é™¤è¯¯æŠ¥è¯æ±‡
2. è°ƒæ•´ `match_type` ä¸º "word" æ¨¡å¼
3. è®¾ç½® `case_sensitive` ä¸º true æé«˜ç²¾ç¡®åº¦

### Q: å¦‚ä½•æé«˜æ£€æµ‹æ€§èƒ½ï¼Ÿ
A: 
1. å‡å°‘æ•æ„Ÿè¯æ•°é‡
2. ä½¿ç”¨æ›´ç²¾ç¡®çš„åŒ¹é…æ¨¡å¼
3. è°ƒæ•´ `contains_all` å‚æ•°

### Q: æ”¯æŒå…¶ä»–è¯­è¨€æ¨¡å‹å—ï¼Ÿ
A: å½“å‰ä¸»è¦æ”¯æŒé€šä¹‰åƒé—®ï¼Œä½†å¯ä»¥æ‰©å±•æ”¯æŒå…¶ä»–OpenAIå…¼å®¹çš„APIã€‚

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ•æ„Ÿè¯ä¼˜åŒ–**: å®šæœŸæ¸…ç†æ— æ•ˆæ•æ„Ÿè¯
2. **ç¼“å­˜æœºåˆ¶**: å¯¹å¸¸è§æŸ¥è¯¢ç»“æœè¿›è¡Œç¼“å­˜
3. **æ‰¹é‡å¤„ç†**: ä½¿ç”¨æ‰¹é‡APIè°ƒç”¨å‡å°‘å»¶è¿Ÿ
4. **å¼‚æ­¥å¤„ç†**: å¯¹äºå¤§é‡è¯·æ±‚ä½¿ç”¨å¼‚æ­¥å¤„ç†

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

1. **APIå¯†é’¥ç®¡ç†**: ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯
2. **è®¿é—®æ§åˆ¶**: é™åˆ¶APIè®¿é—®æƒé™
3. **æ—¥å¿—å®‰å…¨**: é¿å…åœ¨æ—¥å¿—ä¸­è®°å½•æ•æ„Ÿä¿¡æ¯
4. **å®šæœŸæ›´æ–°**: åŠæ—¶æ›´æ–°æ•æ„Ÿè¯åº“å’Œä¾èµ–

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ `README.md` è¯¦ç»†æ–‡æ¡£
2. è¿è¡Œ `python test_llm_guard.py` è¿›è¡Œè‡ªæ£€
3. æŸ¥çœ‹ `llm_guard.log` æ—¥å¿—æ–‡ä»¶
4. é€šè¿‡GitHub Issuesè”ç³»æˆ‘ä»¬

---

**ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°æ—¶é—´**: 2025-07-14  
**å…¼å®¹æ€§**: Python 3.8+, llm-guard 0.3.0+
